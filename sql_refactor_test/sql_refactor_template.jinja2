You are an expert SQL developer and database administrator. Your task is to refactor the given SQL query.

<ORIGINAL_QUERY>
{{ source_sql }}
</ORIGINAL_QUERY>

<INSTRUCTIONS>
1. **Target Dialect**: Convert the query to be compatible with the **{{ target_dialect }}** database dialect.
2. **Code Style**: Improve the SQL style for better readability:
   - Use consistent indentation.
   - Apply standard casing for keywords (e.g., {{ keyword_style }}).
   - Format aliases clearly.
3. **Basic Optimization**: Apply simple optimizations if possible, such as using standard JOIN syntax.
4. **Comments**: {% if add_comments %}Add brief inline comments to explain key steps or complex conditions.{% else %}No comments are needed.{% endif %}
</INSTRUCTIONS>

<OUTPUT_FORMAT>
Please provide only the refactored SQL query without any additional explanations.
</OUTPUT_FORMAT>